{%  extends 'shop/basic.html' %}

{% block title %}  {{product.product_name}} {% endblock %}

{% block body %}
{% load static %}

<div class="container my-4">
    <div class="row">
        <div class="col-md-4">
            <div class="row">
                <img src="/media/{{product.image}}" width="280px" height="320px">
            </div><br>
            <div class="row">

                <button class="btn btn-primary buy mx-3">Buy Now</button>
                <button class="btn btn-primary add" id="pr{{product.id}}">Add To Cart</button>


            </div>
            
        </div>
        <div class="col-md-8">
            <h4>{{product.product_name}}</h4>
            <p><b>Rs. {{product.price}} </b></p>
            <p>{{product.desc}}</p>
        </div>
    </div>
</div>



{% endblock %}

{% block js %}
<script>

<!--    if(localStorage.getItem('cart') == null){-->
<!--    var cart = {};-->
<!--    }-->
<!--    else{-->
<!--    cart = JSON.parse(localStorage.getItem('cart'));-->
<!--    document.getElementById('cart').innerHTML = Object.keys(cart).length;-->
<!--    }-->
<!--    $('.cart').click(function(){-->

<!--    var idstr = this.id.toString();-->
<!--    console.log(idstr);-->
<!--    if (cart[idstr] != undefined){-->
<!--    cart[idstr] = cart[idstr] + 1;-->
<!--    }-->
<!--    else{-->
<!--    cart[idstr] =  1;-->
<!--    }-->
<!--    console.log(cart);-->
<!--    localStorage.setItem('cart', JSON.stringify(cart));-->

<!--    });-->
<!--$('#popcart').popover()-->


<!-- ///////////////////////////////////////////////////////////////////////  -->

console.log('working');


    if(localStorage.getItem('cart') == null){
    var cart = {};
    }
    else{
    cart = JSON.parse(localStorage.getItem('cart'));
    document.getElementById('cart').innerHTML = Object.keys(cart).length;
    }
$('.add').click(function(){
console.log('add button clicked');

var idstr = this.id.toString();
console.log(idstr);

if (cart[idstr] != undefined){
cart[idstr] = cart[idstr]+1;
}
else
{

  qty = 1;
  name = ('{{product.product_name}}');
  price = ('{{product.price}}');
  cart[idstr] = [qty, name, parseInt(price)];
}
console.log(cart);
localStorage.setItem('cart', JSON.stringify(cart));
});

$('.buy').click(function(){
var idstr = this.id.toString();
console.log(idstr);

if (cart[idstr] != undefined){
cart[idstr] = cart[idstr]+1;
}
else
{

  qty = 1;
  name = ('{{product.product_name}}');
  price = ('{{product.price}}');
  cart[idstr] = [qty, name, parseInt(price)];
}
console.log(cart);
localStorage.setItem('cart', JSON.stringify(cart));

window.location.href = "/shop/checkout/";

});


</script>
{% endblock %}